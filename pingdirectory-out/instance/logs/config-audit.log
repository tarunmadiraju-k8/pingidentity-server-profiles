#
# This file contains sensitive information, and it should not be shared
# with untrusted individuals. The collect-support-data tool automatically
# redacts this sensitive information when this file is shared with the
# support team, and the tool also supports an --encrypt option to further
# protect this information in transit.
#
# This log file provides a complete history of all configuration changes
# made to this directory server instance.  This includes changes made from
# the command-line, using the console, or directly over LDAP.  Changes are
# expressed using the dsconfig command-line syntax so that they can be
# directly used to identically configure another directory server instance.
# A dsconfig command-line is also included in a comment above each change
# which can be used to undo the change.  This is provided as a guide only
# as undoing some changes (e.g. deleting a backend) will require additional
# steps to recover the original server state.  Additionally, multi-line
# values for command-line arguments are provided in an escaped form that
# dsconfig can use in batch mode, but may not be usable directly from
# a command-line shell.
#
# The config-diff command line tool can also be used to see how the server's
# configuration has changed over time. It leverages the configuration
# archives in the <server-root>/config/archived-configs/ directory, which has
# a complete archive of all config.ldif files for each configuration of the
# server.

# [04/Sep/2020:17:48:40.295 +0000] Offline changes by root
# Undo command: dsconfig set-log-publisher-prop --publisher-name "File-Based Debug Logger" --set enabled:false
dsconfig set-log-publisher-prop --publisher-name "File-Based Debug Logger" --set enabled:true

# [04/Sep/2020:17:48:41.717 +0000] Offline changes by root
# Undo command: dsconfig delete-debug-target --publisher-name "File-Based Debug Logger" --target-name com.unboundid.guitools.replicationcli
dsconfig create-debug-target --publisher-name "File-Based Debug Logger" --target-name com.unboundid.guitools.replicationcli --set debug-level:verbose

# [04/Sep/2020:17:48:42.591 +0000] Offline changes by root
# Undo command: dsconfig delete-debug-target --publisher-name "File-Based Debug Logger" --target-name foo.bar
dsconfig create-debug-target --publisher-name "File-Based Debug Logger" --target-name foo.bar --set debug-level:verbose

# [04/Sep/2020:17:48:43.316 +0000] Offline changes by root
# Undo command: dsconfig set-gauge-prop --gauge-name "License Expiration (Days)" --set warning-value:60.0
dsconfig set-gauge-prop --gauge-name "License Expiration (Days)" --set warning-value:10.0

# [04/Sep/2020:17:48:44.109 +0000] Offline changes by root
# Undo command: dsconfig set-connection-handler-prop --handler-name "HTTPS Connection Handler" --set web-application-extension:Console
dsconfig set-connection-handler-prop --handler-name "HTTPS Connection Handler" --reset web-application-extension

# [04/Sep/2020:17:48:44.778 +0000] Offline changes by root
# Undo command: dsconfig set-monitor-provider-prop --provider-name "Host System" --set enabled:true
dsconfig set-monitor-provider-prop --provider-name "Host System" --reset enabled

# [04/Sep/2020:17:48:45.503 +0000] Offline changes by root
# Undo command: dsconfig set-connection-handler-prop --handler-name "HTTPS Connection Handler" --add http-servlet-extension:Documentation --add "http-servlet-extension:Swagger UI"
dsconfig set-connection-handler-prop --handler-name "HTTPS Connection Handler" --remove http-servlet-extension:Documentation --remove "http-servlet-extension:Swagger UI"

# [04/Sep/2020:17:48:46.153 +0000] Offline changes by root
# Undo command: dsconfig set-gauge-prop --gauge-name "CPU Usage (Percent)" --reset enabled
dsconfig set-gauge-prop --gauge-name "CPU Usage (Percent)" --set enabled:false

# [04/Sep/2020:17:48:46.760 +0000] Offline changes by root
# Undo command: dsconfig set-gauge-prop --gauge-name "License Expiration (Days)" --reset enabled
dsconfig set-gauge-prop --gauge-name "License Expiration (Days)" --set enabled:false

# [04/Sep/2020:17:48:47.406 +0000] Offline changes by root
# Undo command: dsconfig set-gauge-prop --gauge-name "Available File Descriptors" --reset enabled
dsconfig set-gauge-prop --gauge-name "Available File Descriptors" --set enabled:false

# [04/Sep/2020:17:48:48.011 +0000] Offline changes by root
# Undo command: dsconfig set-log-publisher-prop --publisher-name "Data Recovery Log" --set enabled:true
dsconfig set-log-publisher-prop --publisher-name "Data Recovery Log" --set enabled:false

# [04/Sep/2020:17:48:48.755 +0000] Offline changes by root
# Undo command: dsconfig delete-root-dn-user --user-name pingdatasync
dsconfig create-root-dn-user --user-name pingdatasync --set alternate-bind-dn:cn=datasync --set alternate-bind-dn:cn=sync --set "password:{PBKDF2}AAhbQDHKL0333RAA7MIhXkJO4KSFG7cb5Vn3bj97sxhC88hPmUHX1M87VBY=" --set inherit-default-root-privileges:false --set privilege:bypass-acl --set privilege:bypass-pw-policy --set privilege:config-read --set privilege:password-reset --set privilege:unindexed-search

# [04/Sep/2020:17:48:49.388 +0000] Offline changes by root
# Undo command: dsconfig delete-root-dn-user --user-name pingfederate
dsconfig create-root-dn-user --user-name pingfederate --set alternate-bind-dn:cn=fed --set alternate-bind-dn:cn=pf --set alternate-bind-dn:cn=pingfederate --set "password:{PBKDF2}AAjkbg0Q7hEydxAAZ50Jw+v98J1srx2cybE3+KWbIrDnE13Uc3d9VnyeDEw=" --set inherit-default-root-privileges:false --set privilege:config-read --set privilege:password-reset --set privilege:permit-get-password-policy-state-issues --set privilege:proxied-auth --set privilege:unindexed-search --set is-proxyable:prohibited

# [04/Sep/2020:17:48:49.995 +0000] Offline changes by root
# Undo command: dsconfig delete-root-dn-user --user-name pingdirectoryproxy
dsconfig create-root-dn-user --user-name pingdirectoryproxy --set alternate-bind-dn:cn=pingdirectoryproxy --set alternate-bind-dn:cn=proxy --set "password:{PBKDF2}AAjC7z9tFeCbPRAAo5w1v3GFrxH/Gkq0/9wjuU/0bInQUI/yqEsCTLeh28I=" --set privilege:proxied-auth

# [04/Sep/2020:17:48:50.640 +0000] Offline changes by root
# Undo command: dsconfig delete-root-dn-user --user-name pingdatagovernance
dsconfig create-root-dn-user --user-name pingdatagovernance --set alternate-bind-dn:cn=datagov --set alternate-bind-dn:cn=pingdatagovernance --set "password:{PBKDF2}AAhm5Zv2hJAHLRAAh4l4DTtJTzZNUU0oTZ6zWcgfpv/ooRo8N3/8+qV9lKk=" --set inherit-default-root-privileges:false --set privilege:password-reset --set privilege:proxied-auth --set privilege:unindexed-search --set search-result-entry-limit:100000

# [04/Sep/2020:17:48:51.312 +0000] Offline changes by root
# Undo command: dsconfig set-backend-prop --backend-name changelog --set enabled:false --set "changelog-maximum-age:2 d"
dsconfig set-backend-prop --backend-name changelog --set enabled:true --set "changelog-maximum-age:2 h"

# [04/Sep/2020:17:48:51.970 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name pf-connected-identity
dsconfig create-local-db-index --backend-name userRoot --index-name pf-connected-identity --set index-type:equality

# [04/Sep/2020:17:48:52.583 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name pf-oauth-client-id
dsconfig create-local-db-index --backend-name userRoot --index-name pf-oauth-client-id --set index-type:equality --set index-type:ordering --set index-type:substring

# [04/Sep/2020:17:48:53.201 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name pf-oauth-client-name
dsconfig create-local-db-index --backend-name userRoot --index-name pf-oauth-client-name --set index-type:equality --set index-type:ordering --set index-type:substring

# [04/Sep/2020:17:48:53.797 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name pf-oauth-client-last-modified
dsconfig create-local-db-index --backend-name userRoot --index-name pf-oauth-client-last-modified --set index-type:ordering

# [04/Sep/2020:17:48:54.421 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name accessGrantGuid
dsconfig create-local-db-index --backend-name userRoot --index-name accessGrantGuid --set index-type:equality

# [04/Sep/2020:17:48:55.031 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name accessGrantUniqueUserIdentifier
dsconfig create-local-db-index --backend-name userRoot --index-name accessGrantUniqueUserIdentifier --set index-type:equality

# [04/Sep/2020:17:48:55.645 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name accessGrantHashedRefreshTokenValue
dsconfig create-local-db-index --backend-name userRoot --index-name accessGrantHashedRefreshTokenValue --set index-type:equality

# [04/Sep/2020:17:48:56.344 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name accessGrantClientId
dsconfig create-local-db-index --backend-name userRoot --index-name accessGrantClientId --set index-type:equality

# [04/Sep/2020:17:48:57.050 +0000] Offline changes by root
# Undo command: dsconfig delete-local-db-index --backend-name userRoot --index-name accessGrantExpires
dsconfig create-local-db-index --backend-name userRoot --index-name accessGrantExpires --set index-type:ordering

# [04/Sep/2020:17:48:57.755 +0000] Offline changes by root
# Undo command: dsconfig set-access-control-handler-prop --remove 'global-aci:(targetcontrol="1.2.840.113556.1.4.319")(version 3.0; acl "Allow paging for pingfederate"; allow (read) userdn="ldap:///cn=pingfederate,cn=Root DNs,cn=config";)' --remove 'global-aci:(targetcontrol="1.2.840.113556.1.4.473")(version 3.0; acl "Allow Server Sort for pingfederate"; allow (read) userdn="ldap:///cn=pingfederate,cn=Root DNs,cn=config";)'
dsconfig set-access-control-handler-prop --add 'global-aci:(targetcontrol="1.2.840.113556.1.4.319")(version 3.0; acl "Allow paging for pingfederate"; allow (read) userdn="ldap:///cn=pingfederate,cn=Root DNs,cn=config";)' --add 'global-aci:(targetcontrol="1.2.840.113556.1.4.473")(version 3.0; acl "Allow Server Sort for pingfederate"; allow (read) userdn="ldap:///cn=pingfederate,cn=Root DNs,cn=config";)'

# [04/Sep/2020:17:48:58.452 +0000] Offline changes by root
# Undo command: dsconfig set-access-control-handler-prop --remove 'global-aci:(target="ldap:///cn=alerts")(targetattr="*||+")(version 3.0; acl "pingdatagovernance access to the alerts backend"; allow(read,search,compare) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)' --remove 'global-aci:(target="ldap:///cn=monitor")(targetattr="*||+")(version 3.0; acl "pingdatagovernance access to the monitor backend"; allow(read,search,compare) userdn="ldap:///cn=Govepingdatagovernance,cn=Root DNs,cn=config";)' --remove 'global-aci:(target="ldap:///ou=people,dc=example,dc=com")(targetattr="*||+")(version 3.0; acl "pingdatagovernance access to user store data"; allow(all) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)' --remove 'global-aci:(targetattr="uid||entryUUID||isMemberOf")(version 3.0; acl "pingdatagovernance access to selected attributes"; allow(all) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)' --remove 'global-aci:(targetcontrol="1.2.840.113556.1.4.1413||1.3.6.1.1.13.2||1.3.6.1.4.1.30221.2.5.2||1.3.6.1.4.1.30221.2.5.40||1.3.6.1.4.1.30221.2.5.44||1.3.6.1.1.12||2.16.840.1.113730.3.4.3")(version 3.0; acl "pingdatagovernance access to selected controls"; allow (read) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)'
dsconfig set-access-control-handler-prop --add 'global-aci:(target="ldap:///cn=alerts")(targetattr="*||+")(version 3.0; acl "pingdatagovernance access to the alerts backend"; allow(read,search,compare) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)' --add 'global-aci:(target="ldap:///cn=monitor")(targetattr="*||+")(version 3.0; acl "pingdatagovernance access to the monitor backend"; allow(read,search,compare) userdn="ldap:///cn=Govepingdatagovernance,cn=Root DNs,cn=config";)' --add 'global-aci:(target="ldap:///ou=people,dc=example,dc=com")(targetattr="*||+")(version 3.0; acl "pingdatagovernance access to user store data"; allow(all) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)' --add 'global-aci:(targetattr="uid||entryUUID||isMemberOf")(version 3.0; acl "pingdatagovernance access to selected attributes"; allow(all) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)' --add 'global-aci:(targetcontrol="1.2.840.113556.1.4.1413||1.3.6.1.1.13.2||1.3.6.1.4.1.30221.2.5.2||1.3.6.1.4.1.30221.2.5.40||1.3.6.1.4.1.30221.2.5.44||1.3.6.1.1.12||2.16.840.1.113730.3.4.3")(version 3.0; acl "pingdatagovernance access to selected controls"; allow (read) userdn="ldap:///cn=pingdatagovernance,cn=Root DNs,cn=config";)'

# [04/Sep/2020:17:48:59.061 +0000] Offline changes by root
# Undo command: dsconfig delete-plugin --plugin-name ExpiredSessionAutoPurge
dsconfig create-plugin --plugin-name ExpiredSessionAutoPurge --type purge-expired-data --set enabled:true --set datetime-attribute:pf-authn-session-group-expiry-time --set "expiration-offset:1 h" --set purge-behavior:subtree-delete-entries --set base-dn:ou=sessions,dc=example,dc=com --set "filter:(objectClass=pf-authn-session-groups)" --set "polling-interval:20 m"

# [04/Sep/2020:17:48:59.737 +0000] Offline changes by root
# Undo command: dsconfig delete-plugin --plugin-name IdleSessionAutoPurge
dsconfig create-plugin --plugin-name IdleSessionAutoPurge --type purge-expired-data --set enabled:true --set datetime-attribute:pf-authn-session-group-last-activity-time --set "expiration-offset:1 w" --set purge-behavior:subtree-delete-entries --set base-dn:ou=sessions,dc=example,dc=com --set "filter:(objectClass=pf-authn-session-groups)" --set "polling-interval:1 d"

# [04/Sep/2020:17:49:00.357 +0000] Offline changes by root
# Undo command: dsconfig set-recurring-task-prop --task-name "Export All Non-Administrative Backends" --set 'description:Exports the contents of all non-administrative backends to LDIF.  The LDIF exports will be gzip-compressed, and they will be encrypted if the global configuration is set to encrypt LDIF exports by default.  The export will be rate-limited to ten megabytes per second of compressed data to help avoid any noticeable impact on server performance.  The exports will be written into the "ldif" directory below the server root and will be kept for seven days.' --reset ldif-directory --reset encrypt
dsconfig set-recurring-task-prop --task-name "Export All Non-Administrative Backends" --set 'description:Exports the contents of all non-administrative backends to LDIF.  The LDIF exports will be gzip-compressed, and they will be encrypted if the global configuration is set to encrypt LDIF exports by default.  The export will be rate-limited to ten megabytes per second of compressed data to help avoid any noticeable impact on server performance.  The exports will be written into the "/opt/backup" directory of the container and will be kept for seven days.' --set ldif-directory:/opt/backup --set encrypt:true

# [04/Sep/2020:17:49:01.002 +0000] Offline changes by root
# Undo command: dsconfig set-backend-prop --backend-name userRoot --reset compact-common-parent-dn
dsconfig set-backend-prop --backend-name userRoot --set compact-common-parent-dn:ou=people,dc=example,dc=com

# [04/Sep/2020:17:49:47.984 +0000] Offline changes by root
# Undo command: dsconfig set-server-instance-prop --instance-name b1e39ef4129d --set "cluster-name:Directory Server"
dsconfig set-server-instance-prop --instance-name b1e39ef4129d --set cluster-name:cluster_b1e39ef4129d
